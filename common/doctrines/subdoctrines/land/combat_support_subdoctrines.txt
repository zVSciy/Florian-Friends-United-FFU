fire_concentration = {
    track = combat_support
    name = SUBDOCTRINE_FIRE_CONCENTRATION
    description = SUBDOCTRINE_FIRE_CONCENTRATION_DESC
    icon = GFX_doctrine_fire_concentration_medium

    xp_cost = 300
    xp_type = army

    available = {
        has_doctrine = superior_firepower
    }
    visible = {
        has_doctrine = superior_firepower
    }

    ai_will_do = {

        base = 1
        modifier = {
            factor = 75
            original_tag = SOV
        }
        modifier = {
            factor = 75
            original_tag = ENG
        }
        modifier = {
            factor = 75
            original_tag = FRA
        }   
    }

     # EFFECTS
     enable_tactic = tactic_overwhelming_fire

     category_line_artillery = {
        max_organisation = 5
     }

     rewards = {
        standing_barrage = {
        #1
            category_line_artillery = {
                defense = 0.1
            }
        }
        predicted_fire = {
        #2
            category_line_artillery = {
                soft_attack = 0.1
            }
        }
        artillery_groups = {
        #3
            category_line_artillery = {
                breakthrough = 0.05
                defense = 0.05
            }
        }
        dedicated_air_support = {
        #4
            category_line_artillery = {
                soft_attack = 0.1
            }
        }
        weakpoint_studies = {
        #5
            category_line_artillery = {
                ap_attack = 0.1
                hard_attack = 0.05
                defense = 0.05
            }
        }
    }
}

anti_tank_frontline = {
    track = combat_support
    name = SUBDOCTRINE_ANTI_TANK_FRONT
    description = SUBDOCTRINE_ANTI_TANK_FRONT_DESC
    icon = GFX_doctrine_antitank_frontline_medium

    xp_cost = 300
    xp_type = army

    available = {
        always = yes
    }

    ai_will_do = { base = 0 }

     # EFFECTS
     

    engineer = {
        battalion_mult = {
            category = category_line_artillery
            entrenchment = 0.2
            add = yes
        }
    }

    rewards = {
        pakfront = {
        #1
            anti_tank_brigade = {
                defense = 0.2
                ap_attack = 0.1
                soft_attack = 0.2
            }
            mot_anti_tank_brigade = {
                defense = 0.2
                ap_attack = 0.1
                soft_attack = 0.2
            }

            heavy_anti_tank_brigade = {
                defense = 0.2
                ap_attack = 0.1
                soft_attack = 0.2
            }

            pack_antitank_brigade  = {
                defense = 0.2
                ap_attack = 0.1
                soft_attack = 0.2
            }
        }
        emplacement_rotation = {
        #2
            anti_tank_brigade = {
                max_organisation = 10
            }
            mot_anti_tank_brigade = {
                max_organisation = 10
            }
            heavy_anti_tank_brigade = {
                max_organisation = 10
            }
            pack_antitank_brigade  = {
                max_organisation = 10
            }
        }
        weakpoint_studies = {
        #3
            anti_tank_brigade = {
                ap_attack = 0.1
                hard_attack = 0.1
            }
            mot_anti_tank_brigade = {
                ap_attack = 0.1
                hard_attack = 0.1
            }
            heavy_anti_tank_brigade = {
                ap_attack = 0.1
                hard_attack = 0.1
            }
            pack_antitank_brigade  = {
                ap_attack = 0.1
                hard_attack = 0.1
            }
        }
        offensive_deployments = {
        #4
            mot_anti_tank_brigade = {
                defense = 0.2
            }
            anti_tank_brigade = {
                defense = 0.2
            }
            heavy_anti_tank_brigade = {
                defense = 0.2
            }
            pack_antitank_brigade  = {
                defense = 0.2
            }
        }
        assault_anti_tank = {
        #5
            anti_tank_brigade = {
                soft_attack = 0.2
                hard_attack = 0.2
            }
            mot_anti_tank_brigade = {
                soft_attack = 0.2
                hard_attack = 0.2
            }
            heavy_anti_tank_brigade = {
                soft_attack = 0.2
                hard_attack = 0.2
            }
            pack_antitank_brigade  = {
                soft_attack = 0.2
                hard_attack = 0.2
            }
        }
    }
}

flying_batteries = {
    track = combat_support
    name = SUBDOCTRINE_FLYING_BATTERIES
    description = SUBDOCTRINE_FLYING_BATTERIES_DESC
    icon = GFX_doctrine_flying_batteries_medium

    xp_cost = 300
    xp_type = army

    available = {
        OR = {
            has_doctrine = superior_firepower
            has_doctrine = new_mobile_warfare
            has_doctrine = grand_battleplan
        }
        
    }
    visible = {
        OR = {
            has_doctrine = superior_firepower
            has_doctrine = new_mobile_warfare
            has_doctrine = grand_battleplan
        }
    }

    
    ai_will_do = {
        base = 1

        modifier = {
            factor = 0 
            NOT = { has_tech = rocket_artillery } 
        }
    }

     # EFFECTS

    category_anti_air = {
        air_attack = 0.1
    }

    rewards = {
        deployment_drills = {
            category_anti_air = {
                max_organisation = 10
            }
        }
        counter_battery_tasks = {
            
            category_anti_air = {
                reliability = 0.05
                soft_attack = 0.1
                ap_attack = 0.05
            }
        }
        ballistics_corrections = {
            category_anti_air = {
                hard_attack = 0.15
            }
            air_cas_present_factor = 0.1
        }
        mobile_barrages = {
            category_anti_air = {
                default_morale = 0.1
                air_attack = 0.1
            }

        }
        wide_dispersal_positions = {
            category_anti_air = {
                defense = 0.1
                air_attack = 0.1
            }
        }
    }
}

air_cavalry = {
    track = combat_support
    name = SUBDOCTRINE_AIR_CAVALRY
    description = SUBDOCTRINE_AIR_CAVALRY_DESC
    icon = GFX_doctrine_air_cavalry_medium

    xp_cost = 300
    xp_type = army

    available = {
        OR = {
            has_doctrine = superior_firepower
            has_doctrine = new_mobile_warfare
        }
        
    }
    visible = {
        OR = {
            has_doctrine = superior_firepower
            has_doctrine = new_mobile_warfare
        }
    } 

    ai_will_do = { base = 0 }

     # EFFECTS
     category_mobile_artillery = {
        maximum_speed = 0.1
     }

     rewards = {
        airborne_observers = { 
            category_mobile_artillery = {
                soft_attack = 0.1
                hard_attack = 0.1
            }
        }
        service_and_support = {
            category_mobile_artillery = {
                max_strength = 2
            }
        }
        rescue_liasions = {
            category_mobile_artillery = {
                defense = 0.1
                max_organisation = 10
            }
        }

        transport_assault = {
            category_mobile_artillery = {
                breakthrough = 0.1
            }
        }
        intervention_units = {
            category_mobile_artillery = {
                soft_attack = 0.15
                hard_attack = 0.1
                maximum_speed = 0.1
            }
        }
     }
}

mobile_recon_and_assault = {
    track = combat_support
    name = SUBDOCTRINE_MOBILE_RECON_AND_ASSAULT
    description = SUBDOCTRINE_MOBILE_RECON_AND_ASSAULT_DESC
    icon = GFX_doctrine_mobile_recon_assault_medium

    xp_cost = 300
    xp_type = army

    available = {
        OR = {
            has_doctrine = mass_assault
            has_doctrine = grand_battleplan
        }
        
    }
    visible = {
        OR = {
            has_doctrine = mass_assault
            has_doctrine = grand_battleplan
        }
    }
    
    ai_will_do = {

        base = 1
        modifier = {
            factor = 75
            original_tag = GER
        }
        modifier = {
            factor = 75
            original_tag = USA
        }
        modifier = {
            factor = 0
            is_major = no
        }
    }
    

    category_line_artillery = {
        max_strength = 1
    }

    rewards = {

        motorization_support = {
            category_line_artillery = {
                maximum_speed = 0.1
                default_morale = 0.2
            }

        }
        long_range_reconnaissance = {
            category_line_artillery = {
                max_strength = 1
            }
        }
        mobile_operational_deployments = {
            category_line_artillery = {
                soft_attack = 0.05
                hard_attack = 0.05
            }

        }
        self_propelled_support_elements = {
            category_line_artillery = {
                max_organisation = 10
            }
        }
        deep_reconnaissance_focus = {
           max_dig_in_factor = 0.1
        }
    }
}

siege_artillery = {
    track = combat_support
    name = SUBDOCTRINE_SIEGE_ARTILLERY
    description = SUBDOCTRINE_SIEGE_ARTILLERY_DESC
    icon = GFX_doctrine_siege_artillery_medium

    xp_cost = 300
    xp_type = army

    available = {
        has_doctrine = grand_battleplan
    }
    visible = {
        has_doctrine = grand_battleplan
    }

    ai_will_do = { base = 0 }

    super_heavy_artillery = {
        battalion_mult = {
            category = category_army
            soft_attack = 0.1
            defense = 0.1
        }
    }

    equipment_bonus = {
        railway_gun_equipment = {
            railway_gun_attack = 0.25
            instant = yes
        }
        super_heavy_railway_gun_equipment = {
            railway_gun_attack = 0.25
            instant = yes
        }
    }

    rewards = {

        fortress_busters = {
            super_heavy_artillery = {
                fort = {
                    attack = 0.25
                }
            }
            self_propelled_super_heavy_artillery = {
                fort = {
                    attack = 0.25
                }
            }
        }
        improved_transport_preparation = {
            category_line_artillery = {
                default_morale = 0.2
            }
            super_heavy_artillery = {
                plains = {
                    movement = 0.1
                }
            }
            self_propelled_super_heavy_artillery = {
                plains = {
                    movement = 0.1
                }
            }

            equipment_bonus = {
                railway_gun_equipment = {
                    railway_gun_hours_between_redistribution = -0.5
                    instant = yes
                }
                super_heavy_railway_gun_equipment = {
                    railway_gun_hours_between_redistribution = -0.5
                    instant = yes
                }
                
            }
        }
        precomputed_firing_data = {
            super_heavy_artillery = {
                max_organisation = 10
                defense = 0.2
            }
            self_propelled_super_heavy_artillery = {
                max_organisation = 10
                defense = 0.2
            }

        }
        urban_strongpoint_sieges = {

            category_artillery = {
                soft_attack = 0.05
            }
            super_heavy_artillery = {
                urban = {
                    attack = 0.2
                }
            }
            self_propelled_super_heavy_artillery = {
                urban = {
                    attack = 0.2
                }
            }
        }
        mobile_artillery_command = {
            category_support_artillery = {
                max_organisation = 10
            }
            self_propelled_super_heavy_artillery = {
                max_organisation = 10
                maximum_speed = 0.5
            }

            equipment_bonus = {
                railway_gun_equipment = {
                    maximum_speed = 1
                    instant = yes
                }
                super_heavy_railway_gun_equipment = {
                    maximum_speed = 1
                    instant = yes
                }

            }
        }
    }
}

field_engineering = {
    track = combat_support
    name = SUBDOCTRINE_FIELD_ENGINEERING
    description = SUBDOCTRINE_FIELD_ENGINEERING_DESC
    icon = GFX_doctrine_field_engineering_medium

    xp_cost = 300
    xp_type = army
    
    ai_will_do = { 
        base = 1
        modifier = {
            factor = 75
            original_tag = ITA
        }
        modifier = {
            factor = 75
            original_tag = JAP
        }
    }

    available = {
        has_doctrine = mass_assault
    }
    visible = {
        has_doctrine = mass_assault
    }

    engineer = {
        river = {
            attack = 0.05
            defence = 0.05
        }
        forest = {
            attack = 0.05
            defence = 0.05
        }
    }
    mech_engineers = {
        river = {
            attack = 0.05
            defence = 0.05
        }
        forest = {
            attack = 0.05
            defence = 0.05
        }
    }
    pioneer_support = {
        river = {
            attack = 0.05
            defence = 0.05
        }
        forest = {
            attack = 0.05
            defence = 0.05
        }
    }
    armored_engineer = {
        river = {
            attack = 0.05
            defence = 0.05
        }
        forest = {
            attack = 0.05
            defence = 0.05
        }
    }
    #TODO_JBE: replace with category of engineers
    rewards = {
        rapid_fire_lane_clearance = {
            engineer = {
                max_organisation = 5
                battalion_mult = {
                    category = category_all_infantry
                    entrenchment = 0.05
                }
            }
            maintenance_company = {
                max_organisation = 5
            }
            
        }
        sapper_fieldcraft = {
            engineer = {
                max_strength = 0.25
                defense = 0.1
            }
            maintenance_company = {
                max_strength = 2
            }
        }
        engineerdug_gun_emplacements = {
            engineer = {
                battalion_mult = {
                    category = category_artillery
                    soft_attack = 0.1
                    defense = 0.1
                }
            }
        }
        smoke_projector_training = {
            engineer = {
                breakthrough = 0.5
            }
            maintenance_company = {
                supply_consumption = -0.01
                battalion_mult = {
                    category = category_tanks
                    reliability = 0.05
                    strength = 0.05
                }
            }

        }
        charge_and_flame = {
            engineer = {
                max_organisation = 5
                soft_attack = 0.05
                hard_attack = 1  
            }
            maintenance_company = {
                max_organisation = 5
            }
        }

    }
}
